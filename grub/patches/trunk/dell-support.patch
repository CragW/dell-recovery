This patch sets up the default directories to install to
the target the MBR of the first hard disk from C:\factory.

It's analogous to calling grub-setup.exe like this:

# grub-setup -d C:\factory -r "(//./PHYSICALDRIVE0/)" "//./PHYSICALDRIVE0/"

After this patch, it's possible to just install like this:

# grub-setup.exe

Index: grub2-2.00/include/grub/emu/misc.h
===================================================================
--- grub2-2.00.orig/include/grub/emu/misc.h	2012-02-09 17:22:27.000000000 -0600
+++ grub2-2.00/include/grub/emu/misc.h	2013-02-25 12:08:02.553024206 -0600
@@ -36,8 +36,12 @@
 /* NetBSD uses /boot for its boot block.  */
 # define DEFAULT_DIRECTORY	"/"GRUB_DIR_NAME
 #else
+#ifdef __MINGW32__
+# define DEFAULT_DIRECTORY      "C:/factory"
+#else
 # define DEFAULT_DIRECTORY	"/"GRUB_BOOT_DIR_NAME"/"GRUB_DIR_NAME
 #endif
+#endif
 
 #define DEFAULT_DEVICE_MAP	DEFAULT_DIRECTORY "/device.map"
 
Index: grub2-2.00/util/grub-setup.c
===================================================================
--- grub2-2.00.orig/util/grub-setup.c	2013-02-25 12:07:04.000000000 -0600
+++ grub2-2.00/util/grub-setup.c	2013-02-25 12:11:02.613025638 -0600
@@ -83,6 +83,8 @@
  * result.
  */
 
+#define DELL_TARGET "//./PHYSICALDRIVE0/"
+
 #define DEFAULT_BOOT_FILE	"boot.img"
 #define DEFAULT_CORE_FILE	"core.img"
 #define CORE_IMG_IN_FS		"setup_left_core_image_in_filesystem"
@@ -494,6 +496,13 @@
 
     assert (nsec <= maxsec);
 
+    /* Ignore failures in the embedding test */
+    if (grub_errno != GRUB_ERR_NONE)
+    {
+        grub_errno = GRUB_ERR_NONE;
+        grub_util_warn("The embedding test declared a failure.  This is normally non-fatal during WinPE, so it will be ignored.");
+    }
+
     /* Clean out the blocklists.  */
     block = first_block;
     while (block->len)
@@ -1071,9 +1080,11 @@
         break;
 
       case ARGP_KEY_NO_ARGS:
-          fprintf (stderr, "%s", _("No device is specified.\n"));
-          argp_usage (state);
+          fprintf(stderr, "Installing GRUB2 to `%s'\n", DELL_TARGET);
+          /*
+	  argp_usage (state);
 	  exit (1);
+          */
           break;
 
       default:
@@ -1109,7 +1120,7 @@
 int
 main (int argc, char *argv[])
 {
-  char *root_dev = NULL;
+  char *root_dev = DELL_TARGET;
   char *dest_dev = NULL;
   struct arguments arguments;
 
@@ -1151,7 +1162,10 @@
   grub_mdraid1x_init ();
   grub_lvm_init ();
 
-  dest_dev = get_device_name (arguments.device);
+  if (arguments.device)
+      dest_dev = get_device_name (arguments.device);
+  else
+      dest_dev = grub_util_get_grub_dev (DELL_TARGET);
   if (! dest_dev)
     {
       /* Possibly, the user specified an OS device file.  */
@@ -1193,5 +1207,6 @@
   free (root_dev);
   free (dest_dev);
 
+  fprintf (stderr, "%s", _("Completed successfully.\n"));
   return 0;
 }
