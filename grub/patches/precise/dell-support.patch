This patch sets up the default directories to install to
the target the MBR of the first hard disk from C:\factory.

It's analogous to calling grub-setup.exe like this:

# grub-setup -d C:\factory -r "(//./PHYSICALDRIVE0/)" "//./PHYSICALDRIVE0/"

After this patch, it's possible to just install like this:

# grub-setup.exe

Index: grub2-1.99/include/grub/emu/misc.h
===================================================================
--- grub2-1.99.orig/include/grub/emu/misc.h	2013-01-23 12:47:13.900052704 -0600
+++ grub2-1.99/include/grub/emu/misc.h	2013-01-23 12:47:14.544052733 -0600
@@ -36,8 +36,12 @@
 /* NetBSD uses /boot for its boot block.  */
 # define DEFAULT_DIRECTORY	"/"GRUB_DIR_NAME
 #else
+#ifdef __MINGW32__
+# define DEFAULT_DIRECTORY      "C:/factory"
+#else
 # define DEFAULT_DIRECTORY	"/"GRUB_BOOT_DIR_NAME"/"GRUB_DIR_NAME
 #endif
+#endif
 
 #define DEFAULT_DEVICE_MAP	DEFAULT_DIRECTORY "/device.map"
 
Index: grub2-1.99/util/grub-setup.c
===================================================================
--- grub2-1.99.orig/util/grub-setup.c	2013-01-23 12:47:14.300052722 -0600
+++ grub2-1.99/util/grub-setup.c	2013-01-23 15:46:37.284534803 -0600
@@ -75,6 +75,8 @@
  * result.
  */
 
+#define DELL_TARGET "//./PHYSICALDRIVE0/"
+
 #define DEFAULT_BOOT_FILE	"boot.img"
 #define DEFAULT_CORE_FILE	"core.img"
 #define CORE_IMG_IN_FS		"setup_left_core_image_in_filesystem"
@@ -190,6 +192,8 @@
   struct grub_boot_blocklist *first_block, *block;
   char *tmp_img;
   int i;
+  if (!root)
+    root = DELL_TARGET;
   grub_disk_addr_t first_sector;
 #ifdef GRUB_MACHINE_PCBIOS
   grub_uint16_t current_segment
@@ -439,6 +443,13 @@
 	goto unable_to_embed;
       }
 
+    /* Ignore failures in the embedding test */
+    if (grub_errno != GRUB_ERR_NONE)
+    {
+        grub_errno = GRUB_ERR_NONE;
+        grub_util_warn("The embedding test declared a failure.  This is normally non-fatal during WinPE, so it will be ignored.");
+    }
+
     /* Clean out the blocklists.  */
     block = first_block;
     while (block->len)
@@ -831,8 +842,8 @@
         break;
 
       case ARGP_KEY_NO_ARGS:
-          fprintf (stderr, "%s", _("No device is specified.\n"));
-          argp_usage (state);
+          fprintf(stderr, "Installing GRUB2 to `%s'\n", DELL_TARGET);
+          //argp_usage (state);
           break;
 
       default:
@@ -914,7 +925,10 @@
   grub_mdraid1x_init ();
   grub_lvm_init ();
 
-  dest_dev = get_device_name (arguments.device);
+  if (arguments.device)
+      dest_dev = get_device_name (arguments.device);
+  else
+      dest_dev = grub_util_get_grub_dev (DELL_TARGET);
   if (! dest_dev)
     {
       /* Possibly, the user specified an OS device file.  */
@@ -946,8 +960,10 @@
 
       root_dev = xstrdup (root_dev);
     }
-  else
+  else if (arguments.device)
     {
+      root_dev = dest_dev;
+      /*
       char *root_device =
         grub_guess_root_device (arguments.dir ? : DEFAULT_DIRECTORY);
 
@@ -962,6 +978,7 @@
       grub_util_info ("guessed root device `%s' and root_dev `%s' from "
                       "dir `%s'", root_device, root_dev,
                       arguments.dir ? : DEFAULT_DIRECTORY);
+      */
     }
 
 #if defined(__linux__) || defined(__FreeBSD__) || defined(__FreeBSD_kernel__)
@@ -1022,8 +1039,10 @@
   free (arguments.root_dev);
   free (arguments.dev_map);
   free (arguments.device);
-  free (root_dev);
+  if (root_dev != DELL_TARGET)
+    free (root_dev);
   free (dest_dev);
 
+  fprintf (stderr, "%s", _("Completed successfully.\n"));
   return 0;
 }
